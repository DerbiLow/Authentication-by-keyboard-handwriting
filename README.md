# Authentication_by_keyboard_handwriting
# Скнытая аутентификация на основе клавиатурного почерка и движений мыши
# Исследование методов скрытой аутентификации пользователей

# Введение в курсовом проекте
В современном мире любая информационная система имеет слабые места и может быть подвержена атакам. Одной из самых распространённых угроз является попытка несанкционированного доступа к ценной информации. <br> 
Анализируя статистику угроз информационной безопасности организаций, можно констатировать, что наибольший вред организации наносится именно её работниками, то есть, главное направление угроз - это угрозы внутренние. На сегодняшний день внутренние угрозы составляют более 80%, поскольку действия злонамеренного инсайдера крайне сложно выявить. Деятельность инсайдера - инцидент информационной безопасности, при котором действия сотрудника организации не соответствуют его нормам обычного поведения. Пользователи, будучи сотрудниками организации, следуют определённому распорядку рабочего дня, характер их работы может иметь некоторые особенности в определённые дни недели, в работе они используют конкретные приложения. Каждый пользователь имеет уникальный клавиатурный почерк и свойственный ему набор привычек. Отметим, что клавиатурный почерк пользователя может меняться в зависимости от времени суток в связи с хронотипом владельца. В совокупности перечисленные особенности формируют «цифровую метрику» пользователя, характеризующую его поведение. Тогда аномалии в поведении могут свидетельствовать о потенциальном инциденте безопасности. 

В практической части проекта представлена программная реализация метода скрытой аутентификации на основе мониторинга клавиатурного почерка пользователя. Сформированы уникальные датасеты, собрана статистика.

К уникальной поведенческой характеристике относится клавиатурный почерк - поведенческая биометрическая характеристика, которую описывают следующие параметры: <br>
* Скорость ввода - количество введённых символов разделённое на время печатания
* Динамика ввода - характеризуется временем между нажатиями клавиш и временем их удержания
* Частота возникновения ошибок при вводе - частота использования клавиш «Backspace» и «Delete».
* Использование клавиш - самые часто нажимаемые клавиши, какие клавиши используются при удалении символа, при ввода заглавных букв.

Аутентификация по клавиатурному почерку позволяет с большей точностью определить подлинность объекта аутентификации, а также не позволяет объекту отказаться от авторства. Число независимых динамических признаков взаимодействующего с компьютером оператора ограничено. Прежде всего следует выделить особенности так называемого клавиатурного почерка. Печатание текста с использованием клавиатуры характеризуется работой 20 мышц плечевого пояса на каждой руке. Человек не может сразу выполнить сложные движения. По современным представлениям в процессе обучения он подбирает удачные решения поставленной задачи и запоминает их путём неоднократных повторений. Программы управления мышцами запоминаются в подсознательной сфере, запускаются сознанием и реализуются автоматически. Каждый индивид находит своё решение задачи управления - вот идеологическая основа методов идентификации личности по динамике воспроизведения быстрых подсознательных движений. 

Скрытая аутентификация по клавиатурному почерку может быть выполнена в трёх форматах:<br>
* **Тестирование при вводе фиксированного слова** - скорость ввода слова будет варьироваться. Используя несколько кандидатов и множество попыток, через некоторое время будет получена статистика. Для улучшения её точности, подобные испытания необходимо провести повторно несколько раз. Получив большой набор данных, необходимо провести сравнительный анализ с другими испытуемыми. Таким образом будет получен некий диапазон скоростей набора слова, количество ошибок при вводе запароленной фразы, а также некоторые особенности взаимодействия пользователя и клавиатуры. У такого способа аутентификации есть существенный недостаток - при смене пароля, все данные станут сразу не актуальными. Также после успешной аутентификации пользователь системы может передать управление злоумышленнику, тогда будет практически невозможно проверить факт подмены.<br>
* **Непрерывное тестирование (Мониторинг)** - предполагает непрерывную проверку действий пользователя. Параметры необходимо мониторить для каждого отдельного приложения. Для улучшения точности данные необходимо собирать в долгосрочные переменные. Получив определённое количество параметров, необходимо провести сравнительный анализ с другими испытуемыми, для корректировки порогового значения. Также возможно получить среднюю статистику по определённому приложению. Существенный недостаток такого метода аутентификации - смена настроения или поведения пользователя. Используя уже имеющиеся данные в долгосрочных переменных, программа будет часто выдавать предупреждение, что пользователь системы ведёт себя подозрительно. При каждой успешной аутентификации необходимо корректировать долгосрочные переменные, чтобы постараться минимизировать влияние психофизического состояния оператора. В отдельной таблице или списке необходимо вести данные «эталонного» пользователя. При постоянном мониторинге можно выявить факт подмены пользователя за рабочей станцией. В таком способе мониторинга используются отрывки с фиксированным количеством символов.<br>
* **Алгоритм, анализирующий клавиатурный почерк, после ввода дополнительной фразы** - анализ действий пользователя происходит уже после введения текстового фрагмента. Такой алгоритм имеет большую точность, но при этом большую медлительность, так как фрагмент текста может состоять из множества различных символов. Такая проверка может вызывать негатив у объекта аутентификации, потому что введение фрагмента текста, состоящего из 1000 символов, может занимать большой период времени. Алгоритм основан на сборе статистики из выборки временных значений. Основной параметр - время удержания клавиш. Эталонная модель пользователя создаётся в режиме обучения, когда программа собирает данные о пользователе. Вся информация структурируется в таблицу, где каждая новая строка содержит информацию о времени удержания клавиши, а также саму клавишу. После сбора всех данных высчитывается математическое ожидание каждой выборки, и эталон сохраняется в учётной записи. После ввода пароля (идентификатора), пользователь вводит фиксированный фрагмент текста. По ходу ввода текста, программа высчитывает статистические данные и сравнивает их с сохранёнными эталонными значениями математических ожиданий различных выборок.
  
**Преимущества аутентификации по клавиатурному почерку:** <br>
* Простота реализации и внедрения. Реализация программная, ввод осуществляется со стандартного устройства, а значит не требует ни какого дополнительного оборудования. Самый дешёвый способ аутентификации по биометрическим характеристикам субъекта.<br>
* Не требует от пользователя ни каких дополнительных действий, кроме привычных ему. Пользователь так или иначе взаимодействует с программой или вводит пароль, который можно назначить кодовой фразой в программе.<br>
* Возможность скрытой аутентификации. Пользователь системы даже не будет знать, что включена дополнительная проверка, а значит не сможет сообщить об этом злоумышленнику. Также скрытый метод аутентификации позволит вести журналы событий, в которых будут записываться все необходимые параметры для дальнейшей проверки наиболее подозрительных пользователей.<br>

**Недостатки аутентификации по клавиатурному почерку:** <br>
* Требует обучения приложения. Любой программе, даже самой простой необходим этап сбора информации и её корректировке. Программа должна быть «гибкой» и подстраиваться под каждого пользователя индивидуально, поэтому предпочтительно использовать нейронные сети. <br>
* Сильная зависимость от эргономичности клавиатуры. При смене типа клавиатуры систему придётся заново переучивать или перестраивать под новую клавиатуру. <br>
* Сильная зависимость от психофизического состояния оператора. Если у человека изменилось настроение или он не важно себя чувствует, то система не даст ему аутентифицироваться.

# Принцип работы программы
Если ShowWindow(FindWindowA("ConsoleWindowClass", NULL), 1) содержит параметр 1, то откроется консоль для режима отладки. Если параметр 0, то программа будет работать в фоновом режиме, все данные будут сохранены в файл. Параметр равен 1. После запуска приложения появляется окно, показанное на рисунке ниже. На скриншоте можно увидеть текущий открытый файл, который содержит информацию о пользователе, программе и типе данных. Тип «new» подразумевает процесс сбора данных, тип «user» проверяет пользователя. <br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/49e59e32-bf59-4c0e-885f-440dcaedc738)<br>

При нажатии клавиш, в консоли появляется отладочная информация о количестве клавиш.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/725a150b-48be-45da-aadc-f1b3c028743e)<br>

При сборе определённого количества клавиш. Начинается сбор следующей краткосрочной итерации <br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/8270e190-9550-4b56-8a65-8b1599904d43)<br>

Когда краткосрочных итераций становится больше, чем одна. Программа программа начинает высчитывать параметры, путём вычисления среднего значения.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/ef883396-b8df-4d8c-a1d9-b7b7bd9285a8)<br>

Аналогичная информация дублируется в информационный файл. При сборе нескольких краткосрочных итераций, программа выведет следующее сообщение.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/05501602-6c1b-4f84-86b1-cbcfe4842719)<br>

Далее идёт процесс корректировки порога ошибки. Программа высчитывает количество ошибок. На основе этой информации формируется порог ошибки.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/c4e5d65c-fb19-4b71-99b1-0e7c024ae4f8)<br>

Когда порог ошибки будет скорректирован, программа перейдёт в режим мониторинга.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/5d27d907-4bb5-4088-b7d2-188f6458ade6)<br>

При совпадении параметров, программа обновит данные в файле.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/cd6881e1-dcfe-421b-9831-538c7778d324)<br>

При грубом нарушении нескольких параметров, программа сформирует уникальный ключ, который содержит внутри себя параметры, которые её показались подозрительными.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/6ae994f5-7c4f-483f-961a-1073fbf59d11)<br>

Если действия пользователя вышли за пределы допустимых значений несколько раз подряд, то программа сделает несколько скриншотов.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/d974556f-ff3a-4b78-9618-d09a852fbfbd)<br>

Также информационный файл содержит в себе параметры мыши и нажатую клавишу.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/45fbccd0-06e0-4c6b-ac49-d2f6f637ebae)<br>

Файл, содержащий данные пользователя выглядит следующим образом. В нем отображается среднее количество нажатых клавиш за краткосрочную итерацию и за все время (L_). Время итераций, а также длительности нажатия клавиш отображается в миллисекундах. Корректировка ошибки в параметре TRUEE/FALSE. А также суммарное передвижение мыши по X/Y.<br>
![image](https://github.com/DerbiLow/Authentication-by-keyboard-handwriting/assets/126500303/2e8b1139-fc1b-48d0-b17e-7078844ebd6b) <br>

# Датасеты
Датасет - обработанный и структурированный массив данных. В нём у каждого объекта есть конкретные свойства: признаки, связи между объектами. Его используют, чтобы строить гипотезы или делать выводы, а также обучать нейросети.
	Для анализа датасетов используется множество различных признаков, а также объектов.
	Способы сбора информации для датасетов делят на два типа:
Ручной - люди, без всякой автоматизации осматривают объекты и описывают их признаки. Этот способ используется чаще всего при создании датасетов для распознования изображений
Автоматический - системы сбора информации сразу собирают и структурируют данные в таблицу или любой другой документ. Таким образом можно «собрать» датасет из анкеты пользователя на сайте.
	Датасет может быть сформирован в виде:
Простой записи - таблицы. При этом явной связи между признаками в таблице нет. Это самый популярный способ оформления датасета.
Граф - данные о связях между объектами, которые могут быть представлены визуально в виде схемы из объектов, соединённых между собой.
Упорядоченные записи - таблица, в которой огромную роль играет конкретное расположение элементов внутри этой таблицы.
	Для создания собственных датасетов участнику эксперимента было предложено 5 различных приложений. В каждом из них он должен был провести минимум 15 минут, активно пользуясь приложением. Результаты сравнений параметров, а также датасеты представлены ниже.

 # Результаты

В результате выполнения курсового проекта были исследованы различные способы идентификации и аутентификации. Исходя из изученных материалов были сделаны выводы: оценка психофизиологического и эмоционального состояний пользователя с помощью анализа клавиатурного почерка и движения мыши может быть информативной, а существующие алгоритмы идентификации, аутентификации пользователя по клавиатурному почерку могут быть применены в целях определения состояния пользователя, но требуется проведение работ по поиску новых способов выделения информативных признаков, характерных паттернов и эффективных методов их распознавания. Это в будущем позволит разработать программное средство, которое определяло бы психофизиологическое состояние пользователя и в будущем создать систему, способную определять начальные признаки изменения психоэмоционального состояния. <br>
При проведении эксперимента были использованы данные, соответствующие активности реального пользователя при работе с различными приложениями, построенная модель является устойчивой для тестовых данных. Метод может быть использован для непрерывной аутентификации пользователя в средствах защиты информации от несанкционированного доступа, что позволит контролировать не только предоставление доступа в начале, но и в течение всего времени поддержания сессии. Указанная модификация позволит обнаруживать факты вмешательства в сессию легитимного пользователя, а также факты неавторизованной передачи доступа, тем самым расширив функционал указанных средств защиты информации. Текущая версия приложения позволит собирать статистику данных пользователя. Для дальнейшего её улучшения и сбора достоверных данных, необходимо реализовать клиент-серверную архитектуру, а также использовать нейронные сети, которые позволят более гибко сверять результаты тестирования с данными в базе. На данном этапе приложение работает на основе простых математических вычислений, что не позволяет добиться высокой точности собираемых данных, поэтому увеличивается вероятность ошибки. В дальнейшей работе возможно расширение цифровой метрики пользователя активностью процессов и сетевых портов, взаимодействием пользователя и процессов с файловой системой и событиями операционной системы, что позволит сформировать цифрового двойника пользователя и сместить фокус с аутентификации на обнаружение инцидентов и определение аномалий в его поведении, а также в работе его автоматизированного рабочего места.<br>

**UPD (04/06/2024)** <br>

На текущий момент работы приостановлены из-за особенностей функции обработки нажатия клавиш. Основная проблема - недостоверность собираемых данных. <br>
При удержании одной клавиши, например, клавиша «W» в копмьютерной игре для передвижения вперед, программа считывает примерно до 10-20 нажатий в секунду. Если в этот момент нажать любую другую клавишу и оставить при этом нажатой клавишу «W», то программа перестает считать нажатия именно клавиши «W», сколько бы долго ее не держать нажатой. То есть поточная обработка нескольких нажатий одновременна невозможна. Ищутся способы решения этой проблемы. Возможен переход на другой язык программирования.















　　　　
